import { MainStatsByType, SubStatsByMain } from "./combinations";
import { MainStat, MainStats, Stats, SubStats, Types } from "./enums";

export type StatMap<T extends Types> = { [Stat in MainStatsByType<T>]: number };
export type TypeMap = { [T in Types]: StatMap<T> };

export const mainStatChances: TypeMap = {
  [Types.Flower]: {
    [Stats.HPFlat]: 1,
  },
  [Types.Plume]: {
    [Stats.ATKFlat]: 1,
  },
  [Types.Sands]: {
    [Stats.HP]: 0.8/3,
    [Stats.ATK]: 0.8/3,
    [Stats.DEF]: 0.8/3,
    [Stats.ER]: 0.1,
    [Stats.EM]: 0.1,
  },
  [Types.Goblet]: {
    [Stats.HP]: 0.2125,
    [Stats.ATK]: 0.2125,
    [Stats.DEF]: 0.2,
    [Stats.Pyro]: 0.05,
    [Stats.Electro]: 0.05,
    [Stats.Cryo]: 0.05,
    [Stats.Hydro]: 0.05,
    [Stats.Anemo]: 0.05,
    [Stats.Geo]: 0.05,
    [Stats.Physical]: 0.05,
    [Stats.EM]: 0.025,
  },
  [Types.Circlet]: {
    [Stats.HP]: 0.22,
    [Stats.ATK]: 0.22,
    [Stats.DEF]: 0.22,
    [Stats.CR]: 0.1,
    [Stats.CD]: 0.1,
    [Stats.HB]: 0.1,
    [Stats.EM]: 0.04,
  },
};

const dmgBonusChances: {
  [SubStat in SubStatsByMain<Stats.Physical>]: number;
} = {
  [Stats.HPFlat]: 6/44,
  [Stats.ATKFlat]: 6/44,
  [Stats.DEFFlat]: 6/44,
  [Stats.HP]: 4/44,
  [Stats.ATK]: 4/44,
  [Stats.DEF]: 4/44,
  [Stats.ER]: 4/44,
  [Stats.EM]: 4/44,
  [Stats.CR]: 3/44,
  [Stats.CD]: 3/44,
};

export type SubChanceMap<MS extends MainStat> = {
  [SubStat in SubStatsByMain<MS>]: number;
};
export type MainSubChanceMap<T extends Types> = {
  [MainStat in MainStatsByType<T>]: SubChanceMap<MainStat>;
};
export type TypeMainSubChanceMap = {
  [T in Types]: MainSubChanceMap<T>;
};
export const subStatChances: TypeMainSubChanceMap = {
  [Types.Flower]: {
    [Stats.HPFlat]: {
      [Stats.ATKFlat]: 6/38,
      [Stats.DEFFlat]: 6/38,
      [Stats.HP]: 4/38,
      [Stats.ATK]: 4/38,
      [Stats.DEF]: 4/38,
      [Stats.ER]: 4/38,
      [Stats.EM]: 4/38,
      [Stats.CR]: 3/38,
      [Stats.CD]: 3/38,
    },
  },
  [Types.Plume]: {
    [Stats.ATKFlat]: {
      [Stats.HPFlat]: 6/38,
      [Stats.DEFFlat]: 6/38,
      [Stats.HP]: 4/38,
      [Stats.ATK]: 4/38,
      [Stats.DEF]: 4/38,
      [Stats.ER]: 4/38,
      [Stats.EM]: 4/38,
      [Stats.CR]: 3/38,
      [Stats.CD]: 3/38,
    },
  },
  [Types.Sands]: {
    [Stats.HP]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.ATK]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.ATK]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.HP]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.DEF]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.HP]: 0.1,
      [Stats.ATK]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.ER]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.HP]: 0.1,
      [Stats.ATK]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.EM]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.HP]: 0.1,
      [Stats.ATK]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
  },
  [Types.Goblet]: {
    [Stats.HP]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.DEF]: 0.1,
      [Stats.ATK]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.ATK]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.DEF]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.DEF]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.ATK]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.Pyro]: dmgBonusChances,
    [Stats.Electro]: dmgBonusChances,
    [Stats.Cryo]: dmgBonusChances,
    [Stats.Hydro]: dmgBonusChances,
    [Stats.Anemo]: dmgBonusChances,
    [Stats.Geo]: dmgBonusChances,
    [Stats.Physical]: dmgBonusChances,
    [Stats.EM]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.ATK]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
  },
  [Types.Circlet]: {
    [Stats.HP]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.DEF]: 0.1,
      [Stats.ATK]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.ATK]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.DEF]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.DEF]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.ATK]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.EM]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
    [Stats.CR]: {
      [Stats.HPFlat]: 6/41,
      [Stats.ATKFlat]: 6/41,
      [Stats.DEFFlat]: 6/41,
      [Stats.ATK]: 4/41,
      [Stats.HP]: 4/41,
      [Stats.DEF]: 4/41,
      [Stats.ER]: 4/41,
      [Stats.EM]: 4/41,
      [Stats.CD]: 3/41,
    },
    [Stats.CD]: {
      [Stats.HPFlat]: 6/41,
      [Stats.ATKFlat]: 6/41,
      [Stats.DEFFlat]: 6/41,
      [Stats.ATK]: 4/41,
      [Stats.HP]: 4/41,
      [Stats.DEF]: 4/41,
      [Stats.ER]: 4/41,
      [Stats.EM]: 4/41,
      [Stats.CR]: 3/41,
    },
    [Stats.HB]: dmgBonusChances,
    [Stats.EM]: {
      [Stats.HPFlat]: 0.15,
      [Stats.ATKFlat]: 0.15,
      [Stats.DEFFlat]: 0.15,
      [Stats.ATK]: 0.1,
      [Stats.HP]: 0.1,
      [Stats.DEF]: 0.1,
      [Stats.ER]: 0.1,
      [Stats.CR]: 0.075,
      [Stats.CD]: 0.075,
    },
  },
};

export const upgradeTiers: Record<SubStats, [number, number, number, number]> =
  {
    [Stats.HPFlat]: [209, 239, 269, 299],
    [Stats.HP]: [4.1, 4.7, 5.3, 5.8],
    [Stats.ATKFlat]: [14, 16, 18, 19],
    [Stats.ATK]: [4.1, 4.7, 5.3, 5.8],
    [Stats.DEFFlat]: [16, 19, 21, 23],
    [Stats.DEF]: [5.1, 5.8, 6.6, 7.3],
    [Stats.CR]: [2.7, 3.1, 3.5, 3.9],
    [Stats.CD]: [5.4, 6.2, 7.0, 7.8],
    [Stats.ER]: [4.5, 5.2, 5.8, 6.5],
    [Stats.EM]: [16, 19, 21, 23],
  };

  export const mainStatValues: Record<MainStats, [number, number]> =
  {
    [Stats.HPFlat]: [717, 4780],
    [Stats.HP]: [7, 46.6],
    [Stats.ATKFlat]: [47, 311],
    [Stats.ATK]: [7, 46.6],
    [Stats.DEF]: [9, 58.3],
    [Stats.CR]: [5, 31.1],
    [Stats.CD]: [9, 62.2],
    [Stats.ER]: [8, 51.8],
    [Stats.EM]: [28, 187],
    [Stats.HB]: [5, 35.9],
    [Stats.Pyro]: [7, 46.6],
    [Stats.Electro]: [7, 46.6],
    [Stats.Cryo]: [7, 46.6],
    [Stats.Hydro]: [7, 46.6],
    [Stats.Anemo]: [7, 46.6],
    [Stats.Geo]: [7, 46.6],
    //[Stats.Dendro]:  [7, 46.6],
    [Stats.Physical]: [9, 58.3],
  };
